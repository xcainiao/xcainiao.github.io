<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>关于WinAFL | Hello</title>
    <meta name="description" content="1">
    
    
    <link rel="preload" href="/assets/css/0.styles.153793e6.css" as="style"><link rel="preload" href="/assets/js/app.fb63a1b9.js" as="script"><link rel="preload" href="/assets/js/15.7d96271b.js" as="script"><link rel="prefetch" href="/assets/js/10.6aae25a8.js"><link rel="prefetch" href="/assets/js/11.e5a6ecb1.js"><link rel="prefetch" href="/assets/js/12.e6734d6c.js"><link rel="prefetch" href="/assets/js/13.c45be31f.js"><link rel="prefetch" href="/assets/js/14.7fe2edb8.js"><link rel="prefetch" href="/assets/js/16.d5c5556b.js"><link rel="prefetch" href="/assets/js/17.1a634ded.js"><link rel="prefetch" href="/assets/js/18.e6787f4e.js"><link rel="prefetch" href="/assets/js/19.a31276f8.js"><link rel="prefetch" href="/assets/js/2.6cf84733.js"><link rel="prefetch" href="/assets/js/20.f1ebd130.js"><link rel="prefetch" href="/assets/js/21.9fd25a7d.js"><link rel="prefetch" href="/assets/js/22.7ec64c15.js"><link rel="prefetch" href="/assets/js/23.a0a7d0ea.js"><link rel="prefetch" href="/assets/js/24.c17f3010.js"><link rel="prefetch" href="/assets/js/25.9bbf45e5.js"><link rel="prefetch" href="/assets/js/26.4f930016.js"><link rel="prefetch" href="/assets/js/27.b6d66343.js"><link rel="prefetch" href="/assets/js/28.ded43c8f.js"><link rel="prefetch" href="/assets/js/29.35b25580.js"><link rel="prefetch" href="/assets/js/3.88ebc755.js"><link rel="prefetch" href="/assets/js/30.a0b7fe3b.js"><link rel="prefetch" href="/assets/js/31.89d75be7.js"><link rel="prefetch" href="/assets/js/32.d7c054e6.js"><link rel="prefetch" href="/assets/js/33.9a5f3e99.js"><link rel="prefetch" href="/assets/js/34.ee5cfb6f.js"><link rel="prefetch" href="/assets/js/35.2054ab64.js"><link rel="prefetch" href="/assets/js/36.73bb48c1.js"><link rel="prefetch" href="/assets/js/37.5a1d6d20.js"><link rel="prefetch" href="/assets/js/38.c7d42097.js"><link rel="prefetch" href="/assets/js/39.fd864930.js"><link rel="prefetch" href="/assets/js/4.dc8e7db2.js"><link rel="prefetch" href="/assets/js/40.6c289e11.js"><link rel="prefetch" href="/assets/js/41.0ed23031.js"><link rel="prefetch" href="/assets/js/42.10b887da.js"><link rel="prefetch" href="/assets/js/43.d348e521.js"><link rel="prefetch" href="/assets/js/44.f98660b8.js"><link rel="prefetch" href="/assets/js/45.a141b3d0.js"><link rel="prefetch" href="/assets/js/46.3a3b1b86.js"><link rel="prefetch" href="/assets/js/47.d2f1996d.js"><link rel="prefetch" href="/assets/js/48.0bd12b2f.js"><link rel="prefetch" href="/assets/js/5.6adfd92b.js"><link rel="prefetch" href="/assets/js/6.f9bcea16.js"><link rel="prefetch" href="/assets/js/7.ad2cffde.js"><link rel="prefetch" href="/assets/js/8.8932bce4.js"><link rel="prefetch" href="/assets/js/9.892cc635.js">
    <link rel="stylesheet" href="/assets/css/0.styles.153793e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="page-main"><div class="component-nav-menu"><div class="placeholder"></div> <div class="search-wrapper"><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-4180" class="el-autocomplete"><div class="el-input el-input--prefix"><!----><input type="text" autocomplete="off" valueKey="title" placeholder="请输入内容" fetchSuggestions="function () { [native code] }" triggerOnFocus="true" debounce="300" placement="bottom-start" popperAppendToBody="true" background-color="#eee" class="el-input__inner"><span class="el-input__prefix"><i class="el-input__icon el-icon-search"></i></span><!----><!----><!----></div><div role="region" class="el-autocomplete-suggestion el-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div> <ul role="menubar" class="el-menu--horizontal el-menu" style="background-color:;"><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        Home
      </li><li role="menuitem" tabindex="-1" class="el-menu-item is-active" style="color:;border-bottom-color:;background-color:;">
        Blog
      </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        TimeLine
      </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        Github
      </li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        About
      </li></ul></div> <div class="page-container"><div class="component-page"><div class="page-content"><!----> <div class="content custom"><h2 id="_0x1-winafl-run"><a href="#_0x1-winafl-run" aria-hidden="true" class="header-anchor">#</a> 0x1 winafl run</h2> <p>fuzzlib.dll</p> <div class="language- extra-class"><pre class="language-text"><code>extern &quot;C&quot; __declspec(dllexport) int vulfunc(char *s)
{
	int len=10;
	char buf[20];
	char *p=0;

	memset(buf, '\0', 20);
	len = s[15];
	//p = (char *)s[20];
	//memcpy(buf, s, len);
	//printf(&quot;%d\n&quot;, s[20]);
	if (s[20] != '1'&amp;&amp;s[21] == '1') {
		printf(&quot;bug..................................\n&quot;);
		memset(p, '\0', len);
	}
	else
		printf(&quot;111111111111111111111\n&quot;);
	return 0;
}
</code></pre></div><p>fuzz.c</p> <div class="language- extra-class"><pre class="language-text"><code>#include &quot;stdafx.h&quot;

#pragma comment(lib,&quot;fuzzlib.lib&quot;)

extern &quot;C&quot; __declspec(dllexport)int vulfunc(char *s);   //函数声明

int main(int argc, char* argv[])
{
	
	char buffer[200];

	if (argc &lt; 2)
		return 0;

	memset(buffer, '\0', 200);
	FILE *test = fopen(argv[1], &quot;r&quot;);
	if (test == NULL)
	{
		return 0;
	}
	fread(buffer, 1, 158, test);
	fclose(test);
	
	if (buffer[0] != 'F'&amp;&amp;buffer[1] == 'u'&amp;&amp;
		buffer[3] == 'z'&amp;&amp;buffer[10] == 'z')
	{
		vulfunc(buffer);
	}
	
    return 0;
}
</code></pre></div><p>DynamoRIO run</p> <div class="language- extra-class"><pre class="language-text"><code>C:\Users\Administrator\Desktop\winafl\DynamoRIO-Windows-7.1.0-1\bin32\drrun.exe -c winafl.dll -debug -target_module fuzz.exe -target_offset 0x1000 -fuzz_iterations 10 -nargs 2 -- fuzz.exe C:\Users\Administrator\Desktop\winafl\winafl-master\bin32\in\test.txt
</code></pre></div><p>afl-run</p> <div class="language- extra-class"><pre class="language-text"><code>afl-fuzz.exe -i in -o out -D C:\Users\Administrator\Desktop\winafl\DynamoRIO-Windows-7.1.0-1\bin32 -t 200000  -- -coverage_module fuzz.exe  -target_module fuzz.exe -target_offset 0x1000 -nargs 1 -- fuzz.exe @@
</code></pre></div><p><img src="/assets/img/winafl-1.91ab4bca.png" alt></p> <h2 id="_0x2-harness"><a href="#_0x2-harness" aria-hidden="true" class="header-anchor">#</a> 0x2 harness</h2> <p>a harness</p> <div class="language- extra-class"><pre class="language-text"><code>#include &quot;stdafx.h&quot;


#include &lt;iostream&gt;
#include &lt;windows.h&gt;

typedef int(__cdecl *MYPROC)(char *s);

int main(int argc, char* argv[])
{
	MYPROC pfFuncInDll = NULL;
	HINSTANCE hinst = LoadLibrary(L&quot;fuzzlib.dll&quot;);
	pfFuncInDll = (MYPROC)GetProcAddress(hinst, &quot;vulfunc&quot;);

	char buffer[200];

	if (argc &lt; 2)
		return 0;

	memset(buffer, '\0', 200);
	FILE *test = fopen(argv[1], &quot;r&quot;);
	fread(buffer, 1, 158, test);
	fclose(test);

	printf(&quot;xxxxxxxxxxxxxxx\n&quot;);
	pfFuncInDll(buffer);

	//system(&quot;pause&quot;);
	return 0;
}
</code></pre></div><p>DynamoRIO run</p> <div class="language- extra-class"><pre class="language-text"><code>C:\Users\Administrator\Desktop\winafl\DynamoRIO-Windows-7.1.0-1\bin32\drrun.exe -c winafl.dll -debug -target_module fuzzmain.exe -target_offset 0x1000 -fuzz_iterations 10 -nargs 2 -- fuzzmain.exe C:\Users\Administrator\Desktop\winafl\winafl-master\bin32\in\test.txt
</code></pre></div><p>afl run</p> <div class="language- extra-class"><pre class="language-text"><code>afl-fuzz.exe -i in -o out -D C:\Users\Administrator\Desktop\winafl\DynamoRIO-Windows-7.1.0-1\bin32 -t 200000  -- -coverage_module fuzzmain.exe  -target_module fuzzmain.exe -target_offset 0x1000 -nargs 2 -- fuzzmain.exe @@
</code></pre></div><p><img src="/assets/img/winafl-2.34b9ab23.png" alt></p></div></div></div></div></div></div>
    <script src="/assets/js/app.fb63a1b9.js" defer></script><script src="/assets/js/15.7d96271b.js" defer></script>
  </body>
</html>
