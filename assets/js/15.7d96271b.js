(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{322:function(t,n,e){t.exports=e.p+"assets/img/winafl-1.91ab4bca.png"},323:function(t,n,e){t.exports=e.p+"assets/img/winafl-2.34b9ab23.png"},344:function(t,n,e){"use strict";e.r(n);var a=[function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"_0x1-winafl-run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x1-winafl-run","aria-hidden":"true"}},[t._v("#")]),t._v(" 0x1 winafl run")]),t._v(" "),a("p",[t._v("fuzzlib.dll")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("extern \"C\" __declspec(dllexport) int vulfunc(char *s)\n{\n\tint len=10;\n\tchar buf[20];\n\tchar *p=0;\n\n\tmemset(buf, '\\0', 20);\n\tlen = s[15];\n\t//p = (char *)s[20];\n\t//memcpy(buf, s, len);\n\t//printf(\"%d\\n\", s[20]);\n\tif (s[20] != '1'&&s[21] == '1') {\n\t\tprintf(\"bug..................................\\n\");\n\t\tmemset(p, '\\0', len);\n\t}\n\telse\n\t\tprintf(\"111111111111111111111\\n\");\n\treturn 0;\n}\n")])])]),a("p",[t._v("fuzz.c")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#include \"stdafx.h\"\n\n#pragma comment(lib,\"fuzzlib.lib\")\n\nextern \"C\" __declspec(dllexport)int vulfunc(char *s);   //函数声明\n\nint main(int argc, char* argv[])\n{\n\t\n\tchar buffer[200];\n\n\tif (argc < 2)\n\t\treturn 0;\n\n\tmemset(buffer, '\\0', 200);\n\tFILE *test = fopen(argv[1], \"r\");\n\tif (test == NULL)\n\t{\n\t\treturn 0;\n\t}\n\tfread(buffer, 1, 158, test);\n\tfclose(test);\n\t\n\tif (buffer[0] != 'F'&&buffer[1] == 'u'&&\n\t\tbuffer[3] == 'z'&&buffer[10] == 'z')\n\t{\n\t\tvulfunc(buffer);\n\t}\n\t\n    return 0;\n}\n")])])]),a("p",[t._v("DynamoRIO run")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("C:\\Users\\Administrator\\Desktop\\winafl\\DynamoRIO-Windows-7.1.0-1\\bin32\\drrun.exe -c winafl.dll -debug -target_module fuzz.exe -target_offset 0x1000 -fuzz_iterations 10 -nargs 2 -- fuzz.exe C:\\Users\\Administrator\\Desktop\\winafl\\winafl-master\\bin32\\in\\test.txt\n")])])]),a("p",[t._v("afl-run")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("afl-fuzz.exe -i in -o out -D C:\\Users\\Administrator\\Desktop\\winafl\\DynamoRIO-Windows-7.1.0-1\\bin32 -t 200000  -- -coverage_module fuzz.exe  -target_module fuzz.exe -target_offset 0x1000 -nargs 1 -- fuzz.exe @@\n")])])]),a("p",[a("img",{attrs:{src:e(322),alt:""}})]),t._v(" "),a("h2",{attrs:{id:"_0x2-harness"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x2-harness","aria-hidden":"true"}},[t._v("#")]),t._v(" 0x2 harness")]),t._v(" "),a("p",[t._v("a harness")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('#include "stdafx.h"\n\n\n#include <iostream>\n#include <windows.h>\n\ntypedef int(__cdecl *MYPROC)(char *s);\n\nint main(int argc, char* argv[])\n{\n\tMYPROC pfFuncInDll = NULL;\n\tHINSTANCE hinst = LoadLibrary(L"fuzzlib.dll");\n\tpfFuncInDll = (MYPROC)GetProcAddress(hinst, "vulfunc");\n\n\tchar buffer[200];\n\n\tif (argc < 2)\n\t\treturn 0;\n\n\tmemset(buffer, \'\\0\', 200);\n\tFILE *test = fopen(argv[1], "r");\n\tfread(buffer, 1, 158, test);\n\tfclose(test);\n\n\tprintf("xxxxxxxxxxxxxxx\\n");\n\tpfFuncInDll(buffer);\n\n\t//system("pause");\n\treturn 0;\n}\n')])])]),a("p",[t._v("DynamoRIO run")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("C:\\Users\\Administrator\\Desktop\\winafl\\DynamoRIO-Windows-7.1.0-1\\bin32\\drrun.exe -c winafl.dll -debug -target_module fuzzmain.exe -target_offset 0x1000 -fuzz_iterations 10 -nargs 2 -- fuzzmain.exe C:\\Users\\Administrator\\Desktop\\winafl\\winafl-master\\bin32\\in\\test.txt\n")])])]),a("p",[t._v("afl run")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("afl-fuzz.exe -i in -o out -D C:\\Users\\Administrator\\Desktop\\winafl\\DynamoRIO-Windows-7.1.0-1\\bin32 -t 200000  -- -coverage_module fuzzmain.exe  -target_module fuzzmain.exe -target_offset 0x1000 -nargs 2 -- fuzzmain.exe @@\n")])])]),a("p",[a("img",{attrs:{src:e(323),alt:""}})])])}],s=e(1),r=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},a,!1,null,null,null);n.default=r.exports}}]);